<!DOCTYPE html>
<html lang="bg">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>OPENTRADING</title>
  <style>
    /* –û—Å–Ω–æ–≤–Ω–∏ CSS –ø—Ä–æ–º–µ–Ω–ª–∏–≤–∏ */
    :root {
      --apple-black: #1D1D1F;
      --apple-gray: #F5F5F7;
      --apple-blue: #007AFF;
      --ios-card-shadow: 0 4px 12px rgba(0,0,0,0.1);
      --night-bg: #000000;
      --night-card: #1C1C1E;
    }
    
    * {
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell;
      background: var(--apple-gray);
      margin: 0;
      -webkit-font-smoothing: antialiased;
      transition: background 0.3s ease;
      overflow-x: hidden;
    }
    
    body.night-mode {
      background: var(--night-bg);
      color: #FFFFFF;
    }
    
    .page-container {
      display: grid;
      grid-template-rows: 1fr auto;
      height: 100vh;
      max-width: 800px;
      margin: 0 auto;
      filter: none;
    }
    
    .nav-bar {
      display: flex;
      justify-content: space-around;
      padding: 12px 0;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(40px);
      border-top: 1px solid #E5E5EA;
      position: fixed;
      bottom: 0;
      width: 100%;
      max-width: 800px;
      z-index: 10;
    }
    
    body.night-mode .nav-bar {
      background: rgba(28,28,30,0.92);
      border-color: #2C2C2E;
    }
    
    .nav-item {
      padding: 10px;
      color: #86868B;
      transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
      cursor: pointer;
      border-radius: 14px;
      font-size: 0.9em;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      user-select: none;
    }
    
    .nav-item.active {
      color: var(--apple-blue);
      background: rgba(0,122,255,0.12);
      transform: translateY(-8px);
    }
    
    .content-section {
      display: none;
      padding: 1.2rem;
      overflow-y: auto;
      margin-bottom: 76px;
      gap: 1.2rem;
    }
    
    .content-section.active {
      display: grid;
      animation: fadeIn 0.3s ease;
    }
    
    .ios-card {
      background: white;
      border-radius: 18px;
      padding: 1.6rem;
      box-shadow: var(--ios-card-shadow);
      transition: all 0.3s ease;
    }
    
    body.night-mode .ios-card {
      background: var(--night-card);
      color: #FFFFFF;
    }
    
    .ios-card h3 {
      margin: 0 0 1rem 0;
      font-size: 1.2em;
    }
    
    .settings-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
    }
    
    .reward-card {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin: 10px 0;
    }
    
    .promo-input {
      display: flex;
      gap: 8px;
      margin-top: 12px;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="password"] {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #E5E5EA;
      font-size: 16px;
    }
    
    button {
      background: var(--apple-blue);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.3s ease;
    }
    
    button:hover {
      background: #0060d0;
    }
    
    /* –£–≤–µ–ª–∏—á–µ–Ω–∏ —Å–µ–∫—Ü–∏–∏ –∑–∞ –≥—Ä–∞—Ñ–∏–∫–∏ –∏ –Ω–æ–≤–∏–Ω–∏ */
    .chart-container, .news-container {
      height: 500px;
      margin: 1rem 0;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: var(--ios-card-shadow);
    }
    
    /* –°—Ç–∏–ª–æ–≤–µ –∑–∞ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞—Ç–µ–ª (switch) */
    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }
    
    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    
    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 24px;
    }
    
    .slider:before {
      position: absolute;
      content: "";
      height: 18px;
      width: 18px;
      left: 3px;
      bottom: 3px;
      background-color: white;
      transition: .4s;
      border-radius: 50%;
    }
    
    input:checked + .slider {
      background-color: var(--apple-blue);
    }
    
    input:checked + .slider:before {
      transform: translateX(26px);
    }
    
    /* –ú–æ–¥–∞–ª–µ–Ω —Å—Ç–∏–ª –∑–∞ –≤—Ö–æ–¥/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–µ–∫—Ä–∞–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–∞—â) */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.75);
      z-index: 100;
      justify-content: center;
      align-items: center;
      padding: 20px;
    }
    
    .modal.active {
      display: flex;
    }
    
    .modal-content {
      background: white;
      border-radius: 10px;
      width: 100%;
      max-width: 420px;
      padding: 30px;
      position: relative;
      animation: fadeIn 0.3s ease;
    }
    
    body.night-mode .modal-content {
      background: var(--night-card);
      color: #FFFFFF;
    }
    
    .modal-header {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      position: relative;
    }
    
    .modal-header h3 {
      margin: 0;
      font-size: 1.6em;
    }
    
    .modal-close {
      position: absolute;
      right: 0;
      top: 0;
      font-size: 1.6em;
      cursor: pointer;
      color: #888;
    }
    
    .logged-message {
      background: rgba(0,122,255,0.12);
      padding: 10px 14px;
      border-radius: 10px;
      margin-bottom: 12px;
      text-align: center;
      font-weight: bold;
    }
    
    /* –°—Ç–∏–ª–æ–≤–µ –∑–∞ login widget-–∞ */
    .login-tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 2px solid #E5E5EA;
    }
    
    .login-tab {
      flex: 1;
      text-align: center;
      padding: 12px;
      cursor: pointer;
      font-size: 1.2em;
      color: var(--apple-black);
    }
    
    .login-tab.active {
      border-bottom: 3px solid var(--apple-blue);
      font-weight: bold;
    }
    
    .login-form > div {
      margin-bottom: 15px;
    }
    
    #loginMessage {
      margin-top: 10px;
      font-weight: bold;
      text-align: center;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* –î–æ–ø—ä–ª–Ω–∏—Ç–µ–ª–Ω–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω–∏ —Å—Ç–∏–ª–æ–≤–µ */
    @media (max-width: 600px) {
      .ios-card, .modal-content {
        margin: 0 10px;
        padding: 20px;
      }
      .nav-bar {
        padding: 10px 0;
      }
      .chart-container, .news-container {
        height: 450px;
      }
    }
  </style>
  <script>
    /***************** –§—É–Ω–∫—Ü–∏–∏ –∑–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ *****************/
    const backendUrl = 'http://localhost:3000'; // –ê–∫—Ç—É–∞–ª–∏–∑–∏—Ä–∞–π—Ç–µ, –∞–∫–æ –±–µ–∫–µ–Ω–¥—ä—Ç –µ –Ω–∞ –¥—Ä—É–≥ –∞–¥—Ä–µ—Å

    // –ó–∞—Ä–µ–∂–¥–∞–º–µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω–∏—Ç–µ –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª–∏ –æ—Ç localStorage (–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è ‚Äì –≤ —Ä–µ–∞–ª–Ω–æ—Å—Ç –¥–∞–Ω–Ω–∏—Ç–µ —Ç—Ä—è–±–≤–∞ –¥–∞ —Å–µ —Å—ä—Ö—Ä–∞–Ω—è–≤–∞—Ç –≤ –±–∞–∑–∞ –¥–∞–Ω–Ω–∏)
    function loadUsers() {
      return JSON.parse(localStorage.getItem('users') || '{}');
    }

    function saveUsers(users) {
      localStorage.setItem('users', JSON.stringify(users));
    }

    // –°–µ—Å–∏—è—Ç–∞ —Å–µ —É–ø—Ä–∞–≤–ª—è–≤–∞ –æ—Ç —Å—ä—Ä–≤—ä—Ä–∞ (—á—Ä–µ–∑ httpOnly cookies), –Ω–æ —Ç—É–∫ –∑–∞ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∏–∑–ø–æ–ª–∑–≤–∞–º–µ –∏ localStorage
    function getCurrentUser() {
      return localStorage.getItem('currentUser');
    }

    function setCurrentUser(email) {
      localStorage.setItem('currentUser', email);
    }

    function clearCurrentUser() {
      localStorage.removeItem('currentUser');
    }

    // –ò–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–µ–Ω –∫–æ–¥ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    async function sendVerificationCode() {
      const email = document.getElementById("regEmail").value.trim();
      const messageDiv = document.getElementById("loginMessage");
      messageDiv.style.color = "black";

      if (!email) {
        messageDiv.style.color = "red";
        messageDiv.innerText = "–ú–æ–ª—è, –≤—ä–≤–µ–¥–µ—Ç–µ –≤–∞–ª–∏–¥–µ–Ω –∏–º–µ–π–ª.";
        return;
      }

      try {
        const response = await fetch(`${backendUrl}/send-code`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });
        const data = await response.json();
        if (!response.ok) {
          throw new Error(data.error || "–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∏–∑–ø—Ä–∞—â–∞–Ω–µ—Ç–æ –Ω–∞ –∫–æ–¥–∞.");
        }
        messageDiv.style.color = "green";
        messageDiv.innerText = data.message;
        // –ü—Ä–µ–≤–∫–ª—é—á–≤–∞–Ω–µ –∫—ä–º –≤—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –∫–æ–¥–∞
        document.getElementById("regStep1").style.display = "none";
        document.getElementById("regStep2").style.display = "block";
      } catch (error) {
        messageDiv.style.color = "red";
        messageDiv.innerText = error.message;
      }
    }

    // –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Äì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω –≤—Ö–æ–¥ —Å–ª–µ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
    async function verifyAndRegister() {
      const email = document.getElementById("regEmail").value.trim();
      const password = document.getElementById("regPassword").value.trim();
      const code = document.getElementById("regCode").value.trim();
      const messageDiv = document.getElementById("loginMessage");
      messageDiv.style.color = "black";

      if (!code || !password) {
        messageDiv.style.color = "red";
        messageDiv.innerText = "–ú–æ–ª—è, –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –ø–æ–ª–µ—Ç–∞.";
        return;
      }

      try {
        const response = await fetch(`${backendUrl}/verify-code`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, code })
        });
        const data = await response.json();
        if (!response.ok) {
          throw new Error(data.error || "–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è—Ç–∞.");
        }
        // –ê–∫–æ –∏–º–µ–π–ª—ä—Ç –≤–µ—á–µ —Å—ä—â–µ—Å—Ç–≤—É–≤–∞, –Ω–µ –ø–æ–∑–≤–æ–ª—è–≤–∞–º–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        let users = loadUsers();
        if (users[email]) {
          throw new Error("–¢–æ–∑–∏ –∏–º–µ–π–ª –≤–µ—á–µ –µ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω.");
        }
        // –ó–∞–ø–∏—Å–≤–∞–º–µ –Ω–æ–≤–∏—è –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª
        users[email] = {
          password, 
          balance: 0,
          rewards: {}
        };
        saveUsers(users);
        // –ó–∞–ø–∞–∑–≤–∞–º–µ —Å–µ—Å–∏—è—Ç–∞ ‚Äì –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ–Ω –≤—Ö–æ–¥ —Å–ª–µ–¥ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        setCurrentUser(email);
        messageDiv.style.color = "green";
        messageDiv.innerText = "–£—Å–ø–µ—à–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è! –í–ª–∏–∑–∞–Ω–µ...";
        setTimeout(() => {
          hideModal('loginModal');
          updateUI();
        }, 800);
      } catch (error) {
        messageDiv.style.color = "red";
        messageDiv.innerText = error.message;
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –∑–∞ –≤—Ö–æ–¥ (—Å–∞–º–æ –∏–º–µ–π–ª –∏ –ø–∞—Ä–æ–ª–∞)
    function login() {
      const email = document.getElementById("loginEmail").value.trim();
      const password = document.getElementById("loginPassword").value.trim();
      const messageDiv = document.getElementById("loginMessage");
      messageDiv.style.color = "black";

      if (!email || !password) {
        messageDiv.style.color = "red";
        messageDiv.innerText = "–ú–æ–ª—è, –ø–æ–ø—ä–ª–Ω–µ—Ç–µ –≤—Å–∏—á–∫–∏ –ø–æ–ª–µ—Ç–∞.";
        return;
      }
      let users = loadUsers();
      if (!users[email]) {
        messageDiv.style.color = "red";
        messageDiv.innerText = "–ù—è–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–Ω –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª —Å —Ç–æ–∑–∏ –∏–º–µ–π–ª.";
        return;
      }
      if (users[email].password !== password) {
        messageDiv.style.color = "red";
        messageDiv.innerText = "–ì—Ä–µ—à–Ω–∞ –ø–∞—Ä–æ–ª–∞.";
        return;
      }
      setCurrentUser(email);
      messageDiv.style.color = "green";
      messageDiv.innerText = "–£—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥!";
      hideModal('loginModal');
      updateUI();
    }

    /***************** –§—É–Ω–∫—Ü–∏–∏ –∑–∞ UI *****************/
    function updateUI() {
      const loggedInfo = document.getElementById('loggedInfo');
      const welcomeMessage = document.getElementById('welcomeMessage');
      let currentUser = getCurrentUser();
      if (currentUser) {
        let users = loadUsers();
        let user = users[currentUser];
        welcomeMessage.textContent = `–ó–¥—Ä–∞–≤–µ–π—Ç–µ, ${currentUser}! üëã`;
        let balanceKey = `balance_${currentUser}`;
        let balance = parseInt(localStorage.getItem(balanceKey)) || user.balance || 0;
        document.getElementById('balance').textContent = `${balance} —Ç–∏–∫–µ—Ç–∞`;
        loggedInfo.innerHTML = `<div class="logged-message">
                                    –£—Å–ø–µ—à–Ω–æ –≤–ª—è–∑–æ—Ö—Ç–µ –∫–∞—Ç–æ <strong>${currentUser}</strong>
                                    <br>
                                    <button onclick="logout()">–ò–∑—Ö–æ–¥</button>
                                  </div>`;
        document.getElementById('authSection').style.display = 'none';
      } else {
        welcomeMessage.textContent = '–î–æ–±—Ä–µ –¥–æ—à–ª–∏! üëã';
        loggedInfo.innerHTML = '';
        document.getElementById('authSection').style.display = 'block';
        // –ê–∫–æ –Ω—è–º–∞ –ª–æ–≥–Ω–∞—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –≤–∏–Ω–∞–≥–∏ –ø–æ–∫–∞–∑–≤–∞–º–µ –º–æ–¥–∞–ª–∞ –∑–∞ –≤—Ö–æ–¥/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
        showModal('loginModal');
      }
    }

    function logout() {
      if (confirm("–°–∏–≥—É—Ä–Ω–∏ –ª–∏ —Å—Ç–µ, —á–µ –∏—Å–∫–∞—Ç–µ –¥–∞ –∏–∑–ª–µ–∑–µ—Ç–µ?")) {
        clearCurrentUser();
        updateUI();
        showModal('loginModal');
      }
    }

    // –§—É–Ω–∫—Ü–∏–∏ –∑–∞ –Ω–∞–≥—Ä–∞–¥–∏ –∏ –ø—Ä–æ–º–æ –∫–æ–¥
    function checkLogin() {
      if (!getCurrentUser()) {
        alert("–ú–æ–ª—è, –≤–ª–µ–∑—Ç–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞, –∑–∞ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ —Ç–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è.");
        return false;
      }
      return true;
    }

    function claimReward(amount, rewardKeySuffix) {
      if (!checkLogin()) return;
      let currentUser = getCurrentUser();
      let fullRewardKey = `${rewardKeySuffix}_${currentUser}`;
      if (localStorage.getItem(fullRewardKey)) {
        alert("–í–µ—á–µ —Å—Ç–µ –≤–∑–µ–ª–∏ —Ç–∞–∑–∏ –Ω–∞–≥—Ä–∞–¥–∞.");
        return;
      }
      let balanceKey = `balance_${currentUser}`;
      let balance = parseInt(localStorage.getItem(balanceKey)) || 0;
      balance += amount;
      localStorage.setItem(balanceKey, balance);
      document.getElementById('balance').textContent = `${balance} —Ç–∏–∫–µ—Ç–∞`;
      localStorage.setItem(fullRewardKey, 'claimed');
      alert(`–ü–æ–ª—É—á–∏—Ö—Ç–µ ${amount} —Ç–∏–∫–µ—Ç–∞!`);
    }

    function activatePromo() {
      if (!checkLogin()) return;
      const promoCode = document.getElementById('promoCode').value.trim();
      let currentUser = getCurrentUser();
      const promoKey = `promo_${promoCode}_claimed_${currentUser}`;
      if (localStorage.getItem(promoKey)) {
        alert("–¢–æ–∑–∏ –ø—Ä–æ–º–æ –∫–æ–¥ –≤–µ—á–µ –µ –∏–∑–ø–æ–ª–∑–≤–∞–Ω.");
        return;
      }
      if (promoCode === "TRADEOS") {
        claimReward(50, `promo_${promoCode}`);
        localStorage.setItem(promoKey, 'claimed');
        hideModal('promoModal');
      } else {
        alert("–ù–µ–≤–∞–ª–∏–¥–µ–Ω –ø—Ä–æ–º–æ –∫–æ–¥!");
      }
    }

    /***************** –ú–æ–¥–∞–ª –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è *****************/
    function hideModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) modal.classList.remove('active');
    }

    function showModal(modalId) {
      const modal = document.getElementById(modalId);
      if (modal) modal.classList.add('active');
    }

    function showSection(sectionId) {
      document.querySelectorAll('.nav-item').forEach(nav => {
        nav.classList.toggle('active', nav.dataset.section === sectionId);
      });
      document.querySelectorAll('.content-section').forEach(section => {
        section.classList.toggle('active', section.id === sectionId);
      });
    }

    function switchLoginTab(tab) {
      const loginTab = document.getElementById('loginTab');
      const registerTab = document.getElementById('registerTab');
      const loginForm = document.getElementById('loginForm');
      const registerForm = document.getElementById('registerForm');
      document.getElementById("loginMessage").innerText = "";
      if (tab === 'login') {
        loginTab.classList.add('active');
        registerTab.classList.remove('active');
        loginForm.style.display = 'block';
        registerForm.style.display = 'none';
      } else {
        loginTab.classList.remove('active');
        registerTab.classList.add('active');
        loginForm.style.display = 'none';
        registerForm.style.display = 'block';
        document.getElementById("regStep1").style.display = "block";
        document.getElementById("regStep2").style.display = "none";
      }
    }

    /***************** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è *****************/
    document.addEventListener('DOMContentLoaded', () => {
      updateUI();

      // –ê–∫–æ –Ω—è–º–∞ –ª–æ–≥–Ω–∞—Ç –ø–æ—Ç—Ä–µ–±–∏—Ç–µ–ª, –≥–∞—Ä–∞–Ω—Ç–∏—Ä–∞–º–µ, —á–µ —Å—ä–¥—ä—Ä–∂–∞–Ω–∏–µ—Ç–æ –Ω–µ –µ –¥–æ—Å—Ç—ä–ø–Ω–æ
      if (!getCurrentUser()) {
        showModal('loginModal');
      }
      
      // –ù–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–∏ –±—É—Ç–æ–Ω–∏
      document.querySelectorAll('.nav-item').forEach(item => {
        item.addEventListener('click', function() {
          if (!getCurrentUser()) {
            alert("–ú–æ–ª—è, –≤–ª–µ–∑—Ç–µ –≤ —Å–∏—Å—Ç–µ–º–∞—Ç–∞, –∑–∞ –¥–∞ –∏–∑–ø–æ–ª–∑–≤–∞—Ç–µ —Ç–∞–∑–∏ —Ñ—É–Ω–∫—Ü–∏—è.");
            return;
          }
          document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
          this.classList.add('active');
          const sectionId = this.dataset.section;
          document.querySelectorAll('.content-section').forEach(section => {
            section.classList.remove('active');
          });
          document.getElementById(sectionId).classList.add('active');
        });
      });

      // –ù–æ—â–µ–Ω —Ä–µ–∂–∏–º
      const nightModeToggle = document.getElementById('nightModeToggle');
      nightModeToggle.addEventListener('change', (e) => {
        document.body.classList.toggle('night-mode');
        localStorage.setItem('nightMode', e.target.checked);
      });
    });
  </script>
</head>
<body>
  <div class="page-container">
    <!-- –°–µ–∫—Ü–∏–∏ (–¥–æ—Å—Ç—ä–ø–Ω–∏ —Å–∞–º–æ —Å–ª–µ–¥ —É—Å–ø–µ—à–µ–Ω –≤—Ö–æ–¥) -->
    <section class="content-section active" id="home">
      <div class="ios-card">
        <h3 id="welcomeMessage">–î–æ–±—Ä–µ –¥–æ—à–ª–∏! üëã</h3>
        <p>–í–∞—à–∏—è—Ç –±–∞–ª–∞–Ω—Å: <strong id="balance">0 —Ç–∏–∫–µ—Ç–∞</strong></p>
        <div class="reward-card">
          <button onclick="showSection('rewards')">üéÅ –ù–∞–≥—Ä–∞–¥–∏</button>
          <button onclick="showModal('promoModal')">üé´ –ü—Ä–æ–º–æ –∫–æ–¥</button>
        </div>
      </div>
      <div class="ios-card">
        <h3>–ë—ä—Ä–∑ –¥–æ—Å—Ç—ä–ø ‚ö°</h3>
        <div class="settings-item">
          <span>–¢—ä—Ä–≥–æ–≤–∏—è —Å –∫—Ä–∏–ø—Ç–æ</span>
          <span>‚ûî</span>
        </div>
        <div class="settings-item">
          <span>–ü–æ—Ä—Ç—Ñ–µ–π–ª –∞–Ω–∞–ª–∏–∑</span>
          <span>‚ûî</span>
        </div>
      </div>
    </section>

    <section class="content-section" id="rewards">
      <div class="ios-card">
        <h3>üéÅ –î–Ω–µ–≤–Ω–∏ –Ω–∞–≥—Ä–∞–¥–∏</h3>
        <div class="reward-card">
          <div class="settings-item">
            <span>–î–µ–Ω 1: 10 —Ç–∏–∫–µ—Ç–∞</span>
            <button onclick="claimReward(10, 'reward_day1')">–í–∑–µ–º–∏</button>
          </div>
        </div>
      </div>
    </section>

    <section class="content-section" id="charts">
      <div class="ios-card">
        <h3>–¶–µ–Ω–∏ –≤ —Ä–µ–∞–ª–Ω–æ –≤—Ä–µ–º–µ üìä</h3>
        <div class="chart-container">
          <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
            {
              "autosize": true,
              "symbol": "NASDAQ:AAPL",
              "interval": "D",
              "timezone": "Etc/UTC",
              "theme": "light",
              "style": "1",
              "locale": "bg",
              "allow_symbol_change": true,
              "hide_side_toolbar": false,
              "hidevolume": true,
              "withdateranges": true,
              "studies": [],
              "support_host": "https://www.tradingview.com"
            }
            </script>
          </div>
        </div>
      </div>
    </section>

    <section class="content-section" id="news">
      <div class="ios-card">
        <h3>üì∞ –ù–æ–≤–∏–Ω–∏</h3>
        <div class="news-container">
          <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-timeline.js" async>
            {
              "feedMode": "all_symbols",
              "colorTheme": "light",
              "isTransparent": false,
              "displayMode": "regular",
              "width": "100%",
              "height": "500",
              "locale": "bg"
            }
            </script>
          </div>
        </div>
      </div>
    </section>

    <section class="content-section" id="settings">
      <div class="ios-card">
        <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
        <div id="loggedInfo"></div>
        <div class="settings-item">
          <span>–ù–æ—â–µ–Ω —Ä–µ–∂–∏–º</span>
          <label class="switch">
            <input type="checkbox" id="nightModeToggle">
            <span class="slider"></span>
          </label>
        </div>
        <div id="authSection" style="margin-top: 12px; display:none;">
          <button onclick="showModal('loginModal')">üîê –í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        </div>
      </div>
    </section>

    <nav class="nav-bar">
      <div class="nav-item active" data-section="home">üè† –ù–∞—á–∞–ª–æ</div>
      <div class="nav-item" data-section="charts">üìà –ì—Ä–∞—Ñ–∏–∫–∏</div>
      <div class="nav-item" data-section="news">üì∞ –ù–æ–≤–∏–Ω–∏</div>
      <div class="nav-item" data-section="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
    </nav>
  </div>

  <!-- –ú–æ–¥–∞–ª –∑–∞ –≤—Ö–æ–¥/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–µ–∫—Ä–∞–Ω–Ω–æ –±–ª–æ–∫–∏—Ä–∞—â) -->
  <div class="modal" id="loginModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>–í—Ö–æ–¥ / –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h3>
        <!-- –ë—É—Ç–æ–Ω—ä—Ç –∑–∞ –∑–∞—Ç–≤–∞—Ä—è–Ω–µ –µ —Å–∫—Ä–∏—Ç, –∑–∞ –¥–∞ –Ω–µ –º–æ–∂–µ –º–æ–¥–∞–ª—ä—Ç –¥–∞ —Å–µ –∑–∞—Ç–≤–æ—Ä–∏ –±–µ–∑ –≤–ª–∏–∑–∞–Ω–µ -->
        <span class="modal-close" style="display:none;">√ó</span>
      </div>
      <!-- –¢–∞–±–æ–≤–µ –∑–∞ –ø—Ä–µ–≤–∫–ª—é—á–≤–∞–Ω–µ -->
      <div class="login-tabs">
        <div id="loginTab" class="login-tab active" onclick="switchLoginTab('login')">–í—Ö–æ–¥</div>
        <div id="registerTab" class="login-tab" onclick="switchLoginTab('register')">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
      </div>
      <div id="loginForm" class="login-form">
        <div>
          <input type="email" id="loginEmail" placeholder="–ò–º–µ–π–ª" required />
        </div>
        <div>
          <input type="password" id="loginPassword" placeholder="–ü–∞—Ä–æ–ª–∞" required />
        </div>
        <div>
          <button onclick="login()">–í—Ö–æ–¥</button>
        </div>
      </div>
      <div id="registerForm" class="login-form" style="display: none;">
        <!-- –°—Ç—ä–ø–∫–∞ 1: –ò–º–µ–π–ª –∏ –ø–∞—Ä–æ–ª–∞ + –±—É—Ç–æ–Ω –∑–∞ –∏–∑–ø—Ä–∞—â–∞–Ω–µ –Ω–∞ –∫–æ–¥ -->
        <div id="regStep1">
          <div>
            <input type="email" id="regEmail" placeholder="–ò–º–µ–π–ª" required />
          </div>
          <div>
            <input type="password" id="regPassword" placeholder="–ü–∞—Ä–æ–ª–∞" required />
          </div>
          <div>
            <button onclick="sendVerificationCode()">–ò–∑–ø—Ä–∞—Ç–∏ –∫–æ–¥</button>
          </div>
        </div>
        <!-- –°—Ç—ä–ø–∫–∞ 2: –í—ä–≤–µ–∂–¥–∞–Ω–µ –Ω–∞ –∫–æ–¥–∞ -->
        <div id="regStep2" style="display: none;">
          <div>
            <input type="text" id="regCode" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –∫–æ–¥–∞" required />
          </div>
          <div>
            <button onclick="verifyAndRegister()">–†–µ–≥–∏—Å—Ç—Ä–∏—Ä–∞–π —Å–µ</button>
          </div>
        </div>
      </div>
      <div id="loginMessage"></div>
    </div>
  </div>

  <!-- –ü—Ä–æ–º–æ –º–æ–¥–∞–ª -->
  <div class="modal" id="promoModal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>üé´ –ê–∫—Ç–∏–≤–∏—Ä–∞–π –ø—Ä–æ–º–æ –∫–æ–¥</h3>
        <span class="modal-close" onclick="hideModal('promoModal')">√ó</span>
      </div>
      <div class="promo-input">
        <input type="text" id="promoCode" placeholder="–í—ä–≤–µ–¥–µ—Ç–µ –ø—Ä–æ–º–æ –∫–æ–¥">
        <button onclick="activatePromo()">–ê–∫—Ç–∏–≤–∏—Ä–∞–π</button>
      </div>
    </div>
  </div>
</body>
</html>

